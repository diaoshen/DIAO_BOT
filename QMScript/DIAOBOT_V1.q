[General]
SyntaxVersion=2
BeginHotkey=121
BeginHotkeyMod=0
PauseHotkey=0
PauseHotkeyMod=0
StopHotkey=123
StopHotkeyMod=0
RunOnce=1
EnableWindow=
MacroID=2110f23c-5443-4aed-a625-890ccc89c90e
Description=DIAO_BOT_V1
Enable=1
AutoRun=0
[Repeat]
Type=0
Number=1
[SetupUI]
Type=1
QUI=Form1
[Relative]
SetupOCXFile=
[Comment]

[UIPackage]
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


[Script]
/*
	Globals 
*/
DimEnv start
DimEnv wndX 
DimEnv wndY
DimEnv hpBarX
DimEnv hpBarY
DimEnv kMenuCornerX
DimEnv kMenuCornerY
DimEnv reviveTime
DimEnv runTime
DimEnv hpColor : hpColor = "0B11AD"
Dimenv debugMode : debugMode = 0
Dimenv mode// 1 for RAR , 2 for FREE battle 
Dimenv extraDelay
DimEnv OSSetting : OSSetting = 0 ' 0 for Mac , 1 for Win
/*
	Colors 
*/

Dim departureTimeColor : departureTimeColor = "75611A"' checkDepatureReady()
Dim selfDeadColor : selfDeadColor = "000000"
Dim finishColor : finishColor = "6C5027"
Dim townColor : townColor = "FFFDFE"
Dim departureWarningColor : departureWarningColor = "120F08"'#24

Dim bossColorNames : bossColorNames = Array("Green","Dark Green","Bright Green","Bright Dark Green","Orange","Bright Orange","Bright Dark Orange","Dark Orange", "Bright Red","RED","Dark Red")
Dim bossColors : bossColors = Array("1C9264", "264939", "D1FE68", "435D3C", "036AA5", "B3F0AD", "4B5F58", "1D3F4B", "BA87A6", "080AA8", "1D1F4D")
Dim bossWordArea : bossWordArea = Array(450,129,560,153)
/*
	Coordinates 
*/
//Dim specialBattleX : specialBattleX = 42  : Dim specialBattleY : specialBattleY = 81   ' #2 , used in enroll() 
//Dim raidOffsetX : raidOffsetX = 231  : Dim raidOffsetY : raidOffsetY = 111  ' #3 , used in enroll()
//Dim departSoloOffsetX : departSoloOffsetX = 156 : Dim departSoloOffsetY : departSoloOffsetY = 395  ' #4 , enroll() 
//Dim waitListRegX : waitListRegX = 692 : Dim waitListRegY : waitListRegY =  301 ' #5 , enroll()
//Dim arrowUpX : arrowUpX = 809 :  Dim arrowUpY : arrowUpY = 764 ' #6 , enroll() 
//Dim departureBoxLX : departureBoxLX = 648 : Dim departureBoxLY : departureBoxLY = 729 : Dim departureBoxRX : departureBoxRX = 702 : Dim departureBoxRY : departureBoxRY = 746 ' #7,#8  checkDepatureReady()
//Dim departNowX : departNowX = 708  : Dim departNowY : departNowY = 759 '#9 ,  Go()
//Dim bossHPLX : bossHPLX = 258 : Dim bossHPLY : bossHPLY = 131 : Dim bossHPRX : bossHPRX = 294 : Dim bossHPRY : bossHPRY = 142 ' #10,#11 , isBossHere() , isBossDead() 
//Dim reviveLX : reviveLX = 17 : Dim reviveLY : reviveLY = 474 : Dim reviveRX : reviveRX = 58 : Dim reviveRY : reviveRY = 512  ' #12,#13  ,  isSelfDead()                                                                              
//Dim reviveX  : reviveX =  36 : Dim reviveY  : reviveY =  496 ' #14 , revive()
//Dim finishLX : finishLX = 72 : Dim finishLY : finishLY = 155 : Dim finishRX : finishRX = 254 : Dim finishRY : finishRY = 225 '#15,#16 , Go()  , Exit
//Dim leavePartyX : leavePartyX = 92 : Dim leavePartyY : leavePartyY = 654 '#18 , Go() , Exit
//Dim townLX : townLX = 90 : Dim townLY : townLY = 744 : Dim townRX : townRX = 124 : Dim townRY : townRY = 778 ' #19,#20 , Go() , InTown 
//Dim townX  : townX = 161 : Dim townY  : townY = 633 ' Go() ,  Close party when in town 
//Dim departWarningLX : departWarningLX = 370 : Dim departWarningLY : departWarningLY = 433 : Dim departWarningRX : departWarningRX = 452 : Dim departWarningRY : departWarningRY = 470 '#22,#23
//Dim departWarningYesX : departWarningYesX = 491  : Dim departWarningYesY : departWarningYesY =  454 '#25
//Dim confirmDepartureX : confirmDepartureX = 417 : Dim confirmDepartureY : confirmDepartureY = 580 ' #26 , Go()



DimEnv specialBattleLocX ' #2 , used in enroll() 
DimEnv specialBattleLocY
DimEnv raidOffsetLocX' #3 , used in enroll()
DimEnv raidOffsetLocY
DimEnv departSoloOffsetLocX' #4 , enroll() 
DimEnv departSoloOffsetLocY
DimEnv waitListRegLocX' #5 , enroll()
DimEnv waitListRegLocY
Dimenv arrowUpLocX' #6 , enroll() 
DimEnv arrowUpLocY
Dimenv departureBoxArea1' #7,#8  checkDepatureReady()
Dimenv departureBoxArea2
Dimenv departureBoxArea3
DimEnv departureBoxArea4
Dimenv departNowLocX'#9 ,  Go()
DimEnv departNowLocY
Dimenv bossHPArea1
Dimenv bossHPArea2
Dimenv bossHPArea3
DimEnv bossHPArea4
Dimenv reviveArea1
Dimenv reviveArea2
Dimenv reviveArea3
DimEnv reviveArea4
Dimenv reviveLocX' #14 , revive()    
DimEnv reviveLocY
Dimenv finishArea1'#15,#16 , Go()  , Exit
Dimenv finishArea2
Dimenv finishArea3
DimEnv finishArea4
Dimenv leavePartyLocX
DimEnv leavePartyLocY
Dimenv townArea1' #19,#20 , Go() , InTown 
Dimenv townArea2
Dimenv townArea3
DimEnv townArea4
Dimenv townLocX' Go() ,  Close party when in town        
DimEnv townLocY
Dimenv departWarningArea1'#22,#23
Dimenv departWarningArea2
Dimenv departWarningArea3
DimEnv departWarningArea4
Dimenv departWarningYesLocX' #25
DimEnv departWarningYesLocY
Dimenv confirmDepartureLocX' #26 , Go()
DimEnv confirmDepartureLocY



/*
	Main Control
*/
If debugMode = 1 Then 
	Call debugMain
Else 
	Call main
End If


/**
	 Form Events
*/

Event Form1.Load
    Form1.setWindow.Register True
    Form1.setHP.Register True
    Form1.setK.Register True
	//// Default settings 	
	Form1.InputBox1.Text = 935
	Form1.InputBox2.Text = 174
	Form1.kBoxX.Text = 939
	Form1.kBoxY.Text = 365
	Form1.HPInputBoxX.Text = 1689
	Form1.HPInputBoxY.Text = 218
	If Form1.OptionBox4.Value = 1 Then 
		Call ApplyWinSettings()
	Else 
		Call ApplyMacSettings()
	End If
	Call applySetting()
	Call updateStats()
	
	//// On script start , load GUI stuff 
End Event
//// OS Win Setting 
Event Form1.OptionBox4.Click
	Call ApplyWinSettings()
	Call applySetting()
	Call updateStats()
End Event
//// OS MAC setting 
Event Form1.OptionBox5.Click
	Call ApplyMacSettings()
	Call applySetting()
	Call updateStats()
End Event
Event Form1.runTime.Slide
    Form1.runAmountLabel.Caption = "Run Amount : " & Form1.runTime.Value
    Call updateStats()
End Event
Event Form1.reviveTime.Slide
    Form1.reviveLabel.Caption = "Time to revive : " & (Form1.reviveTime.Value - 1) * 5 + 10 & "s"
    Call updateStats()
End Event
Event Form1.setWindow.Hotkey
    GetCursorPos x, y
    TracePrint "Vindictus Window Corner SetTo : (" & x & "," & y & ")"
    Form1.InputBox1.Text = x 
    Form1.InputBox2.Text = y
    Call updateStats()
End Event
Event Form1.setHP.Hotkey
    GetCursorPos x, y
    TracePrint "HP Coordinate SetTo : (" & x & "," & y & ")"
    Form1.HPInputBoxX.Text = x
    Form1.HPInputBoxY.Text = y
    hpBarX = x
    hpBarY = y
    hpColor = GetPixelColor(x, y)
    Call updateStats()
End Event
Event Form1.setK.Hotkey
    GetCursorPos x, y
    TracePrint "Quick Battle Coordinate SetTo : (" & x & "," & y & ")"
    Form1.kBoxX.Text = x
    Form1.kBoxY.Text = y
    Call updateStats()
End Event
Event Form1.reviveCheckBox.Click
	//shouldRevive = Form1.reviveCheckBox.Value
	Call updateStats() 
End Event
Event Form1.clearSettingButton.Click
	Form1.Grid1.DeleteAllItems 
	Form1.Grid1.SetItemText 1, 0, "Special Battle"
	Form1.Grid1.SetItemText 2, 0, "Raid Offset"
	Form1.Grid1.SetItemText 3, 0, "Depart (Solo)"
	Form1.Grid1.SetItemText 4, 0, "Wait List Registration"
	Form1.Grid1.SetItemText 5, 0, "Arrow Up"
	Form1.Grid1.SetItemText 6, 0, "DepartureTimerBox"
	Form1.Grid1.SetItemText 7, 0, "Depart Now"
	Form1.Grid1.SetItemText 8, 0, "BOSS HP Area"
	Form1.Grid1.SetItemText 9, 0, "SelfDead Area"
	Form1.Grid1.SetItemText 10, 0, "Revive Button"
	Form1.Grid1.SetItemText 11, 0, "Finish Area"
	Form1.Grid1.SetItemText 12, 0, "Leave Party Button"
	Form1.Grid1.SetItemText 13, 0, "Town Area "
	Form1.Grid1.SetItemText 14, 0, "Close Party Button"
	Form1.Grid1.SetItemText 15, 0, "Departure Warning Area"
	Form1.Grid1.SetItemText 16, 0, "Departure Warning (Yes) "
	Form1.Grid1.SetItemText 17, 0, "Confirm Departure (OK) "
End Event
Event Form1.applySettingButton.Click
	Call applySetting()
End Event
Function applySetting()
	specialBattleLocX = Cint(Form1.Grid1.GetItemText(1, 1))
 	specialBattleLocY = Cint(Form1.Grid1.GetItemText(1, 2))
 	raidOffsetLocX = Cint(Form1.Grid1.GetItemText(2,1))
 	raidOffsetLocY = Cint(Form1.Grid1.GetItemText(2,2))
 	departSoloOffsetLocX = Cint(Form1.Grid1.GetItemText(3,1))
 	departSoloOffsetLocY = Cint(Form1.Grid1.GetItemText(3,2))
 	waitListRegLocX = Cint(Form1.Grid1.GetItemText(4,1))
 	waitListRegLocY= Cint(Form1.Grid1.GetItemText(4,2))
 	arrowUpLocX= Cint(Form1.Grid1.GetItemText(5,1))
 	arrowUpLocY= Cint(Form1.Grid1.GetItemText(5,2))
 	departureBoxArea1= Cint(Form1.Grid1.GetItemText(6,1))
 	departureBoxArea2= Cint(Form1.Grid1.GetItemText(6,2))
 	departureBoxArea3= Cint(Form1.Grid1.GetItemText(6,3))
 	departureBoxArea4= Cint(Form1.Grid1.GetItemText(6,4))
 	departNowLocX= Cint(Form1.Grid1.GetItemText(7,1))
 	departNowLocY= Cint(Form1.Grid1.GetItemText(7,2))
 	bossHPArea1= Cint(Form1.Grid1.GetItemText(8,1))
 	bossHPArea2= Cint(Form1.Grid1.GetItemText(8,2))
 	bossHPArea3= Cint(Form1.Grid1.GetItemText(8,3))
 	bossHPArea4= Cint(Form1.Grid1.GetItemText(8,4))
 	reviveArea1 = Cint(Form1.Grid1.GetItemText(9,1))
 	reviveArea2 = Cint(Form1.Grid1.GetItemText(9,2))
 	reviveArea3 = Cint(Form1.Grid1.GetItemText(9,3))
 	reviveArea4= Cint(Form1.Grid1.GetItemText(9,4))
 	reviveLocX=Cint( Form1.Grid1.GetItemText(10,1))
 	reviveLocY= Cint(Form1.Grid1.GetItemText(10,2))
 	finishArea1=Cint( Form1.Grid1.GetItemText(11,1))
 	finishArea2=Cint( Form1.Grid1.GetItemText(11,2))
 	finishArea3=Cint( Form1.Grid1.GetItemText(11,3))
 	finishArea4=Cint( Form1.Grid1.GetItemText(11,4))
 	leavePartyLocX=Cint( Form1.Grid1.GetItemText(12,1))
 	leavePartyLocY=Cint( Form1.Grid1.GetItemText(12,2))
 	townArea1= Cint(Form1.Grid1.GetItemText(13,1))
 	townArea2= Cint(Form1.Grid1.GetItemText(13,2))
 	townArea3= Cint(Form1.Grid1.GetItemText(13,3))
 	townArea4= Cint(Form1.Grid1.GetItemText(13,4))
 	townLocX  =Cint( Form1.Grid1.GetItemText(14,1))
 	townLocY= Cint(Form1.Grid1.GetItemText(14,2))
 	departWarningArea1=Cint( Form1.Grid1.GetItemText(15,1))
 	departWarningArea2= Cint(Form1.Grid1.GetItemText(15,2))
 	departWarningArea3=Cint( Form1.Grid1.GetItemText(15,3))
 	departWarningArea4=Cint( Form1.Grid1.GetItemText(15,4))
 	departWarningYesLocX= Cint(Form1.Grid1.GetItemText(16,1))
 	departWarningYesLocY = Cint(Form1.Grid1.GetItemText(16, 2))
 	confirmDepartureLocX=CInt(Form1.Grid1.GetItemText(17,1))
	confirmDepartureLocY=Cint(Form1.Grid1.GetItemText(17,2))
End Function
//// BOT starts HERE 
Function main()
//	Call addItemToList("---------------------------")
//	Call addItemToList ("RAR BOT V1.5.1 ")
//	Call addItemToList ("Window : " & wndX & " , " & wndY)
//	Call addItemToList ("HP     : " & hpBarX & " , " & hpBarY)
//	Call addItemToList ("KMenu  : " & kMenuCornerX & " , " & kMenuCornerY)
//	Call addItemToList ("RunTime : " & runTime)
//	Call addItemToList ("Revive Time : " & reviveTime)
//	Call addItemToList("Mode : " & mode)
//	If Form1.reviveCheckBox.Value = 1 Then 
//		Call addItemToList("Revive Enabled")
//	Else 
//		Call addItemToList("Revive Disabled")
//	End If
    TracePrint " Window : " & wndX & " , " & wndY
    TracePrint " HP     : " & hpBarX & " , " & hpBarY
    TracePrint " KMenu  : " & kMenuCornerX & " , " & kMenuCornerY
    TracePrint " RunTime : " & runTime
    TracePrint " Revive Time : " & reviveTime
    TracePrint " Mode : " & mode
    Call addItemToList(arrowUpLocX & "," & arrowUpLocY)
    Call addItemToList("-------------------")
    Call addItemToList("Script Starting...")
	If mode = 1 Then 
		For k = 1 To runTime
			t3 = Plugin.Sys.GetTime()
			Call addItemToList("Starting Round : " & k & "/" & runTime)
			TracePrint "Round : " & k
			Call Go()
			t4 = Plugin.Sys.GetTime()
			Call addItemToList("Round " & k & " took " & (t4-t3)/1000/60 & " minutes ")
		Next
	Else 
		//// Exitscript is not checked so keep calling FreeBattle
		While Form1.exitScriptCheckBox.Value = 0
			Call FreeBattle	
		Wend
		If Form1.exitScriptCheckBox.Value = 1 Then 
			Call FreeBattle
		End If
	End If
	Call addItemToList("Script Terminated")
	TracePrint " All Runs have been completed "
End Function
Function debugMain()
	Call addItemToList (" RAR BOT V1 ")
	Call addItemToList (" Window : " & wndX & " , " & wndY)
	Call addItemToList (" HP     : " & hpBarX & " , " & hpBarY)
	Call addItemToList (" KMenu  : " & kMenuCornerX & " , " & kMenuCornerY)
	Call addItemToList (" RunTime : " & runTime)
	Call addItemToList (" Revive Time : " & reviveTime)
    TracePrint " RAR BOT V1 "
    TracePrint " Window : " & wndX & " , " & wndY
    TracePrint " HP     : " & hpBarX & " , " & hpBarY
    TracePrint " KMenu  : " & kMenuCornerX & " , " & kMenuCornerY
    TracePrint " RunTime : " & runTime
    TracePrint " Revive Time : " & reviveTime
    TracePrint " Mode : " & mode

    While True
    	//Call inBattle()
    	//Call keyboardCombo()
    		//Call addItemToList(" Window : " & wndX & " , " & wndY)
    		Call addItemToList(" Finish area 1 : " & finishArea1)
    	Delay 2000
    Wend

End Function

//// Functions 
Function keyboardCombo()
		L(1500)
		R (3500)
		checkHP
		dodge(1000)
		R (3300)
		SPSkill(1000)
		dodge(500)
End Function
Function checkHP()
    FindColorEx hpBarX,hpBar-10,hpBarX+100,hpBarY+10,hpColor,0,0.6,intX,intY
    If intX > 0 And intY > 0 Then 
    	//Call addItemToList("HP Appears to be FULL")
        TracePrint "Full"
    Else 
    	 Call addItemToList("HEALING")
        TracePrint "Need Healing ! "
        KeyPress "4", 4
    End If	
End Function
Function enroll()
	TracePrint "Enroll Called"
    Delay 4000
    KeyPress "K", 1
    Delay 2500
    Call addItemToList("Special Battle : " & "(" & kMenuCornerX & "+" & specialBattleLocX & " , " & kMenuCornerY & "+" & specialBattleLocY & ")")
    MoveTo kMenuCornerX+specialBattleLocX, kMenuCornerY+specialBattleLocY // Select special battle 
    LeftClick 1
    Delay 2500
    Call addItemToList("Raid : " & "(" & kMenuCornerX & "+" & raidOffsetLocX & " , " & kMenuCornerY & "+" & raidOffsetLocY & ")")
    MoveTo kMenuCornerX+raidOffsetLocX, kMenuCornerY+raidOffsetLocY // select battle 
    LeftClick 1
    Delay 2500
    Call addItemToList("DepartSolo : " & "(" & kMenuCornerX & "+" & departSoloOffsetLocX & " , " & kMenuCornerY & "+" & departSoloOffsetLocY & ")")
    MoveTo kMenuCornerX+departSoloOffsetLocX, kMenuCornerY+departSoloOffsetLocY // Depart(solo)
    LeftClick 1
    Delay 2500
    Call addItemToList("WaitListReg : " & "(" & kMenuCornerX & "+" & waitListRegLocX & " , " & kMenuCornerY & "+" & waitListRegLocY & ")")
    MoveTo kMenuCornerX+waitListRegLocX, kMenuCornerY+waitListRegLocY // Wait List Registration 
    LeftClick 1
    Delay 2500
    // Extra depature box 
    //0C1753
    FindColorEx wndX + departWarningArea1, wndY + departWarningArea2, wnd + departWarningArea3, wndY + departWarningArea4, departureWarningColor, 0, 0.9, intX, intY
    If intX > 0 And intY > 0 Then 
    	FindColorEx kMenuCornerX+waitListRegLocX-10, kMenuCornerY+waitListRegLocY-10, kMenuCornerX+waitListRegLocX+10, kMenuCornerY+waitListRegLocY+10, "0C1753", 0, 0.9, intX, intY
    	If intX > 0 And intY > 0 Then 
			TracePrint "Found depature warning "
    		MoveTo wndX+departWarningYesLocX, wndY+departWarningYesLocY// Extra departure OK  
    		LeftClick 1
    		Delay 2500	  		
    	End If
    End If
    Call addItemToList("ArrowUp : " & "(" & wndX & "+" & arrowUpLocX & " , " & wndY & "+" & arrowUpLocY & ")")    
    MoveTo wndX + arrowUpLocX, wndY + arrowUpLocY// Arrow up to show depart buton 
    LeftClick 1
    Delay 2500	
End Function
Function checkDepatureReady()
	TracePrint "checkDepatureReady() Called "
    FindColorEx wndX+departureBoxArea1,wndY+departureBoxArea2,wndX+departureBoxArea3,wndY+departureBoxArea4,departureTimeColor,0,0.7,intX,intY
    If intX > 0 And intY > 0 Then 
    	Call addItemToList("Departure Ready")
        TracePrint "Depature Ready"
        checkDepatureReady = "1"
        Exit Function
    End If
       
	FindColorEx 1205,968,1412,999,"685400",0,0.8,intX,intY
	If intX > 0 And intY > 0 Then 
    	Call addItemToList("Departure Ready")
        TracePrint "Depature Ready"
        checkDepatureReady = "1"
        Exit Function
	End If
	FindColorEx 1205,968,1412,999,"624400",0,0.8,intX,intY
	If intX > 0 And intY > 0 Then 
    	Call addItemToList("Departure Ready")
        TracePrint "Depature Ready"
        checkDepatureReady = "1"
        Exit Function
	End If
	FindColorEx 1205,968,1412,999,"92691B",0,0.8,intX,intY
	If intX > 0 And intY > 0 Then 
    	Call addItemToList("Departure Ready")
        TracePrint "Depature Ready"
        checkDepatureReady = "1"
        Exit Function
	End If
	FindColorEx 1205,968,1412,999,"715A1E",0,0.8,intX,intY
	If intX > 0 And intY > 0 Then 
    	Call addItemToList("Departure Ready")
        TracePrint "Depature Ready"
        checkDepatureReady = "1"
        Exit Function
	End If
    
    ////Call addItemToList("Waiting for depature!")
    TracePrint "Waiting! "
    checkDepatureReady = "0"
End Function
Function isBossHere()
	Dim counter : counter = 0
	For Each item In bossColors
		FindColorEx wndX + bossHPArea1, wndY + bossHPArea2, wndX + bossHPArea3, wndY + bossHPArea4, item, 0, 0.8, intX, intY
		If intX > 0 And intY > 0 Then 
			If mode = 0 Then 
				//CHECK IF BOSS NAME IS THERE 
				If BOSSNAME NOT HERE Then
					isBossHere = 0
					Exit Function
			End If
			TracePrint "Boss Ready"
			Call addItemToList("I see BOSS") 
			isBossHere = 1
			Exit Function
		End If
		counter = counter + 1
	Next
	
    ////Call addItemToList("Waiting for boss to appear")
    TracePrint "Waiting for boss! "
    isBossHere = "0"	
End Function
Function isBossDead()
	Dim counter : counter = 0
	For Each item In bossColors
		FindColorEx wndX + bossHPArea1, wndY + bossHPArea2, wndX + bossHPArea3, wndY + bossHPArea4, item, 0, 0.8, intX, intY
		If intX > 0 And intY > 0 Then 
			Call addItemToList("Boss HP Color : " & bossColorNames(counter))
			TracePrint "Boss HP Color : " & bossColorNames(counter)
			//Additional check for RAR 
			If mode = 0 Then 
				//CHECK ifboss name is gone 
				If BOSSNAME NOT HERE Then 
					isBossDead = 1
				End If
			Else 
				isBossDead = 0	
			End If
			Exit Function
		End If
		counter = counter + 1
	Next
	Call addItemToList("Boss is dead ")
    TracePrint "Boss is dead "
    isBossDead = "1"
End Function
Function revive()
    KeyPress "ESC", 1
    MoveTo wndX+reviveLocX , wndY+reviveLocY // Revive button 
    Delay 2000
    LeftClick 1
    KeyPress "ESC", 1
    MoveTo wndX+reviveLocX , wndY+reviveLocY // Revive button 
    Delay 2000
    LeftClick 1
    Call addItemToList("Revived !")
    TracePrint "Revived"
End Function
Function isSelfDead()
    Delay 300
	Dim deadChance : deadChance = 0
	
	// White Circle 
    FindColorEx wndX+reviveArea1, wndY+reviveArea2, wndX+reviveArea3, wndY+reviveArea4, "F1EFF0", 0, 0.8, intX, intY
    If intX > 0 And intY > 0 Then 
    	deadChance = deadChance + 1
    	TracePrint "White Circle"
    End If
    //Finger Grey 
    FindColorEx wndX+reviveArea1, wndY+reviveArea2, wndX+reviveArea3, wndY+reviveArea4, "6C6E6C", 0, 0.8, intX, intY
    If intX > 0 And intY > 0 Then 
    	TracePrint " Finger Grey "
    	deadChance = deadChance + 1 
    End If
    // Goddess Orange 
    FindColorEx wndX+reviveArea1, wndY+reviveArea2, wndX+reviveArea3, wndY+reviveArea4, "89AACF", 0, 0.8, intX, intY
    If intX > 0 And intY > 0 Then 
    	TracePrint "Goddess Orange"
    	deadChance = deadChance + 1 
    End If
    // Goddess Black 
    FindColorEx wndX+reviveArea1, wndY+reviveArea2, wndX+reviveArea3, wndY+reviveArea4, "010001", 0, 0.8, intX, intY
    If intX > 0 And intY > 0 Then 
    	TracePrint "Goddess Black"
    	deadChance = deadChance + 1 
    End If
    // HP bar 
	FindColorEx hpBarX,hpBarY,hpBarX+10,hpBarY,hpColor,0,0.6,intX,intY
    If intX < 0 And intY < 0 Then 
 		deadChance = deadChance + 1
 	End If
    If deadChance = 5 Then 
    	isSelfDead = 1
        TracePrint "character is dead"
    Else 
        isSelfDead = 0
    End If

End Function
Function addItemToList(item)
	Form1.ListBox1.AddItem item
	Form1.ListBox1.ListIndex = Form1.ListBox1.ListCount-1	
End Function
Function L(time)
	t1 = Plugin.Sys.GetTime()
	t2 = 0
	While t2 - t1 <= time
		KeyPress ",", 1
		Delay 50
		t2 = Plugin.Sys.GetTime()
	Wend	
End Function
Function R(time)
	t1 = Plugin.Sys.GetTime()
	t2 = 0
	While t2 - t1 <= time
		KeyPress ".", 1
		Delay 50
		t2 = Plugin.Sys.GetTime()
	Wend
End Function
Function dodge(time)
	t1 = Plugin.Sys.GetTime()
	t2 = 0
	While t2 - t1 <= time
		KeyPress "/", 1
		Delay 50
		t2 = Plugin.Sys.GetTime()
	Wend	
End Function
Function SPSkill(time)
	t1 = Plugin.Sys.GetTime()
	t2 = 0
	While t2 - t1 <= time
		KeyPress "7", 1
		Delay 50
		t2 = Plugin.Sys.GetTime()
	Wend	
End Function

Function Go()
		/* Enroll*/ 
		Rem enrollStage
        Call enroll
		/* Waiting to get in */
		Call addItemToList("Waiting for depature!")
        Do While True
            Dim ready
            ready = checkDepatureReady()
            If ready = 1 Then 
                MoveTo wndX + departNowLocX, wndY + departNowLocY
                Delay 2000
                LeftClick 1
                MoveTo wndX+confirmDepartureLocX, wndY+confirmDepartureLocY // Confirm use ticket 
                Delay 2000
                LeftClick 1
                Exit Do
            End If
            Delay 2500
        Loop
        Delay 10000
		/* Check if got in */
		Rem waitingRoomStage
		t1 = Plugin.Sys.GetTime()
		t2 = 0
		Call addItemToList("Waiting for boss to appear")
        Do While True
            Dim bossReady
            bossReady = isBossHere()
            If bossReady = 1 Then 
                Exit Do
            End If
            Delay 3000
            t2 = Plugin.Sys.GetTime()
            If t2-t1 > 10000 Then 
            	KeyPress "A", 5 
            	t1 = Plugin.Sys.GetTime()
            	t2 = 0
            End If
        Loop
   		/* In Battle */
   		Rem battleStage
   		Call inBattle
   		/* Exit  */
   		Rem exitStage
		If exitParty() = 0 Then 
			Goto battleStage
		End If
    	/* In Town */
    	Call addItemToList("Loading...")
    	Delay extraDelay
		Call inTown
    	TracePrint "Cycle Completed , Restarting in 3 seconds... "
    	Call addItemToList("Cycle Completed , Restarting in 3 seconds... ")
    	Delay 3000
    	TracePrint "3s passed"
End Function

Function inBattle()
	Dim dead
    Dim selfDead// Self 
    selfDead = 0
    Do While True
    	TracePrint "Fighting...."
    	Call addItemToList("Fighting...")
        dead = isBossDead()
        If dead = 1 Then 
        	For i = 1 To 3
        		dead = isBossDead()
        		Delay 2000
        	Next
            If dead = 1 Then 
            	Exit Do
            End If
        End If
        t1 = Plugin.Sys.GetTime()
        t2 = 0
        selfDead = isSelfDead()
        While selfDead = 1
        	t2 = Plugin.Sys.GetTime()
        	TracePrint "Elapsed Time : " & Int((t2-t1)/1000)
        	If (t2 - t1)/1000 > reviveTime Then 
        		selfDead = 0
        		t1 = t2
        		If Form1.reviveCheckBox.Value = 1 Then 
        			Call addItemToList("Reviving...")
        			TracePrint " Called Revived "
        			Call revive
        		Else 
        			Call addItemToList("Cannot Revive due to checkbox not checked. ")
        		End If
        		Goto here
        	End If
        	Call addItemToList("Time remain to revive : " & Int((reviveTime - (t2-t1)/1000)))
        	selfDead = isSelfDead()
        	If selfDead = 0 Then 
        		KeyPress "F6", 1
        	End If
        	Delay 690
        Wend
        Rem here
        Call keyboardCombo
        Call checkHP
    Loop
End Function

Function exitParty()
	t1 = Plugin.Sys.GetTime()
	t2 = 0
    Do While True
    	Call addItemToList("Searching for exit button")
        FindColorEx wndX+finishArea1, wndY+finishArea2, wndX+finishArea3, wndY+finishArea4, finishColor, 0, 0.7, intX, intY
        If intX > 0 And intY > 0 Then 
            MoveTo wndX + leavePartyLocX, wndY + leavePartyLocY
            TracePrint "Clicked Leave Party"
            Delay 5000
            LeftClick 2
            exitParty = 1
            Exit Function
        End If
        Delay 3000
        // Error recovery , after 30 move to prev stage 
        t2 = Plugin.Sys.GetTime()
        If t2 - t1 > 30000 Then 
        	exitParty = 0
        	Exit Function
        End If 
    Loop	
End Function

Function inTown()
    t1 = Plugin.Sys.GetTime()
    t2 = 0
    Do While True
        FindColorEx wndX+townArea1,wndY+townArea2,wndX+townArea3,wndY+townArea4,townColor,0,0.6,intX,intY
        If intX > 0 And intY > 0 Then 
        	KeyPress "ESC" , 1
            MoveTo wndX+townLocX, wndY+townLocY
            Delay 3000
            LeftClick 1
            Exit Do
        End If
        Delay 3000
        TracePrint "Waiting to go to town..."
        Call addItemToList(" Waiting to go to town...")
        
        // Error recovery , after 30s move to next stage 
        t2 = Plugin.Sys.GetTime()
        If t2 - t1 > 30000 Then 
         	t2 = 0
         	t1 = 0
        	Exit Function
        End If
    Loop
End Function


Function FreeBattle()
	Call inBattle
End Function

Function ApplyWinSettings()
	OSSetting = 1
	Form1.Grid1.SetItemText 1, 0, "Special Battle"
	Form1.Grid1.SetItemText 1, 1, 42
	Form1.Grid1.SetItemText 1, 2, 81
	
	Form1.Grid1.SetItemText 2, 0, "Raid Offset"
	Form1.Grid1.SetItemText 2, 1, 231
	Form1.Grid1.SetItemText 2, 2, 111
	
	Form1.Grid1.SetItemText 3, 0, "Depart (Solo)"
	Form1.Grid1.SetItemText 3, 1, 156
	Form1.Grid1.SetItemText 3, 2, 395
	
	Form1.Grid1.SetItemText 4, 0, "Wait List Registration"
	Form1.Grid1.SetItemText 4, 1, 692
	Form1.Grid1.SetItemText 4, 2, 301
	
	Form1.Grid1.SetItemText 5, 0, "Arrow Up"
	Form1.Grid1.SetItemText 5, 1, 840
	Form1.Grid1.SetItemText 5, 2, 767
	
	Form1.Grid1.SetItemText 6, 0, "DepartureTimerBox"
	Form1.Grid1.SetItemText 6, 1, 678
	Form1.Grid1.SetItemText 6, 2, 725
	Form1.Grid1.SetItemText 6, 3, 720
	Form1.Grid1.SetItemText 6, 4, 746
	
	Form1.Grid1.SetItemText 7, 0, "Depart Now"
	Form1.Grid1.SetItemText 7, 1, 708
	Form1.Grid1.SetItemText 7, 2, 759
	 
	Form1.Grid1.SetItemText 8, 0, "BOSS HP Area"
	Form1.Grid1.SetItemText 8, 1, 258
	Form1.Grid1.SetItemText 8, 2, 131
	Form1.Grid1.SetItemText 8, 3, 294
	Form1.Grid1.SetItemText 8, 4, 142
	
	Form1.Grid1.SetItemText 9, 0, "SelfDead Area"
	Form1.Grid1.SetItemText 9, 1, 15
	Form1.Grid1.SetItemText 9, 2, 423
	Form1.Grid1.SetItemText 9, 3, 61
	Form1.Grid1.SetItemText 9, 4, 500
	
	Form1.Grid1.SetItemText 10, 0, "Revive Button"
	Form1.Grid1.SetItemText 10, 1, 36
	Form1.Grid1.SetItemText 10, 2, 496
	
	Form1.Grid1.SetItemText 11, 0, "Finish Area"
	Form1.Grid1.SetItemText 11, 1, 72
	Form1.Grid1.SetItemText 11, 2, 155
	Form1.Grid1.SetItemText 11, 3, 254
	Form1.Grid1.SetItemText 11, 4, 225
	
	Form1.Grid1.SetItemText 12, 0, "Leave Party Button"
	Form1.Grid1.SetItemText 12, 1, 92
	Form1.Grid1.SetItemText 12, 2, 654
	
	Form1.Grid1.SetItemText 13, 0, "Town Area "
	Form1.Grid1.SetItemText 13, 1, 90
	Form1.Grid1.SetItemText 13, 2, 744
	Form1.Grid1.SetItemText 13, 3, 124
	Form1.Grid1.SetItemText 13, 4, 778
	
	Form1.Grid1.SetItemText 14, 0, "Close Party Button"
	Form1.Grid1.SetItemText 14, 1, 152
	Form1.Grid1.SetItemText 14, 2, 636
	
	Form1.Grid1.SetItemText 15, 0, "Departure Warning Area"
	Form1.Grid1.SetItemText 15, 1, 370
	Form1.Grid1.SetItemText 15, 2, 433
	Form1.Grid1.SetItemText 15, 3, 452
	Form1.Grid1.SetItemText 15, 4, 470
	
	Form1.Grid1.SetItemText 16, 0, "Departure Warning (Yes) "
	Form1.Grid1.SetItemText 16, 1, 491
	Form1.Grid1.SetItemText 16, 2, 454
	
	Form1.Grid1.SetItemText 17, 0, "Confirm Departure (OK) "
	Form1.Grid1.SetItemText 17, 1, 422
	Form1.Grid1.SetItemText 17, 2, 582	
End Function


Function ApplyMacSettings()
	OSSetting = 0
	Form1.Grid1.SetItemText 1, 0, "Special Battle"
	Form1.Grid1.SetItemText 1, 1, 61
	Form1.Grid1.SetItemText 1, 2, 102
	
	Form1.Grid1.SetItemText 2, 0, "Raid Offset"
	Form1.Grid1.SetItemText 2, 1, 438
	Form1.Grid1.SetItemText 2, 2, 143
	
	Form1.Grid1.SetItemText 3, 0, "Depart (Solo)"
	Form1.Grid1.SetItemText 3, 1, 244
	Form1.Grid1.SetItemText 3, 2, 496
	
	Form1.Grid1.SetItemText 4, 0, "Wait List Registration"
	Form1.Grid1.SetItemText 4, 1, 873
	Form1.Grid1.SetItemText 4, 2, 373
	
	Form1.Grid1.SetItemText 5, 0, "Arrow Up"
	Form1.Grid1.SetItemText 5, 1, 1010
	Form1.Grid1.SetItemText 5, 2, 959
	
	Form1.Grid1.SetItemText 6, 0, "DepartureTimerBox"
	Form1.Grid1.SetItemText 6, 1, 796
	Form1.Grid1.SetItemText 6, 2, 90
	Form1.Grid1.SetItemText 6, 3, 1003
	Form1.Grid1.SetItemText 6, 4, 931
	
	Form1.Grid1.SetItemText 7, 0, "Depart Now"
	Form1.Grid1.SetItemText 7, 1, 866
	Form1.Grid1.SetItemText 7, 2, 952
	 
	Form1.Grid1.SetItemText 8, 0, "BOSS HP Area"
	Form1.Grid1.SetItemText 8, 1, 294
	Form1.Grid1.SetItemText 8, 2, 159
	Form1.Grid1.SetItemText 8, 3, 325
	Form1.Grid1.SetItemText 8, 4, 185
	
	Form1.Grid1.SetItemText 9, 0, "SelfDead Area"
	Form1.Grid1.SetItemText 9, 1, 18
	Form1.Grid1.SetItemText 9, 2, 532
	Form1.Grid1.SetItemText 9, 3, 86
	Form1.Grid1.SetItemText 9, 4, 633
	
	Form1.Grid1.SetItemText 10, 0, "Revive Button"
	Form1.Grid1.SetItemText 10, 1, 143
	Form1.Grid1.SetItemText 10, 2, 604
	
	Form1.Grid1.SetItemText 11, 0, "Finish Area"
	Form1.Grid1.SetItemText 11, 1, 116
	Form1.Grid1.SetItemText 11, 2, 209
	Form1.Grid1.SetItemText 11, 3, 312
	Form1.Grid1.SetItemText 11, 4, 262
	
	Form1.Grid1.SetItemText 12, 0, "Leave Party Button"
	Form1.Grid1.SetItemText 12, 1, 119
	Form1.Grid1.SetItemText 12, 2, 819
	
	Form1.Grid1.SetItemText 13, 0, "Town Area "
	Form1.Grid1.SetItemText 13, 1, 50
	Form1.Grid1.SetItemText 13, 2, 921
	Form1.Grid1.SetItemText 13, 3, 196
	Form1.Grid1.SetItemText 13, 4, 973
	
	Form1.Grid1.SetItemText 14, 0, "Close Party Button"
	Form1.Grid1.SetItemText 14, 1, 161
	Form1.Grid1.SetItemText 14, 2, 633
	
	Form1.Grid1.SetItemText 15, 0, "Departure Warning Area"
	Form1.Grid1.SetItemText 15, 1, 569
	Form1.Grid1.SetItemText 15, 2, 427
	Form1.Grid1.SetItemText 15, 3, 740
	Form1.Grid1.SetItemText 15, 4, 455
	
	Form1.Grid1.SetItemText 16, 0, "Departure Warning (Yes) "
	Form1.Grid1.SetItemText 16, 1, 607
	Form1.Grid1.SetItemText 16, 2, 570
	
	Form1.Grid1.SetItemText 17, 0, "Confirm Departure (OK) "
	Form1.Grid1.SetItemText 17, 1, 546
	Form1.Grid1.SetItemText 17, 2, 725	
End Function

Event Form1.WinSetting.Click
	Call ApplyWinSettings()
End Event
Event Form1.MacSetting.Click
	Call ApplyMacSettings()
End Event


Event Form1.getStatsBtn.Click
	Form1.ListBox2.List = ""
	If Form1.OptionBox4.Value = 1 Then 
		Form1.ListBox2.AddItem ("HOST : Windows")
	Else 
		Form1.ListBox2.AddItem("HOST: Mac")
	End If
	/*
		GetWindows
	*/
	Hwnd = Plugin.Window.Find(0,"Vindictus")
	Rect = Plugin.Window.GetWindowRect(Hwnd)
	MyArray = Split(Rect, "|")
	Form1.InputBox1.Text = Clng(MyArray(0))
	Form1.InputBox2.Text = Clng(MyArray(1))
	wndX = Form1.InputBox1.Text
	wndY = Form1.InputBox2.Text
	
	Form1.ListBox2.AddItem("Window : (" & wndX & "," & wndY & ")")
	Form1.ListBox2.AddItem ("HP : (" & hpBarX & "," & hpBarY & ")")
	Form1.ListBox2.AddItem ("KMenu : (" & kMenuCornerX & "," & kMenuCornerY & ")")
	Form1.ListBox2.AddItem ("RunTime : " & runTime)
	Form1.ListBox2.AddItem ("ReviveTime : " & reviveTime)
	If Form1.reviveCheckBox.Value = 1 Then 
		Form1.ListBox2.AddItem ("Revive : Enabled")
	Else 
		Form1.ListBox2.AddItem("Revive : Disabled")
	End If
	Form1.ListBox2.AddItem ("Extra delay: " & extraDelay/1000 & "s")
	If mode = 1 Then 
		Form1.ListBox2.AddItem ("Mode : RAR")
	Else 
		Form1.ListBox2.AddItem("Mode : FREE")
	End If
	If Form1.exitScriptCheckBox.Value = 1 Then 
		Form1.ListBox2.AddItem ("Boss Death : Quit")
	Else 
		Form1.ListBox2.AddItem ("Boss Death : Reset")
	End If
			
End Event


Event Form1.extraDelayBox.Click
	Call updateStats()
End Event


Function updateStats()
Form1.ListBox1.List = ""
    TracePrint "UPDATED"
    wndX = Form1.InputBox1.Text
    wndY = Form1.InputBox2.Text
    hpBarX = Form1.HPInputBoxX.Text
    hpBarY = Form1.HPInputBoxY.Text
    kMenuCornerX = Form1.kBoxX.Text
    kMenuCornerY = Form1.kBoxY.Text
    runTime = Form1.runTime.Value
    reviveTime = (Form1.reviveTime.Value - 1) * 5 + 10
    mode = Form1.OptionBox1.Value
	Call addItemToList("SODIAO v1.5.1 ")
	Call addItemToList("---------------")
	If specialBattleLocX = 42 Then 
		Call addItemToList("HOST : Windows")
	ElseIf specialBattleLocX = 61 Then
		Call addItemToList("HOST : MAC")
	Else 
		Call addItemToList("HOST : NONE")
	End If
	Call addItemToList ("Window : " & wndX & " , " & wndY)
	Call addItemToList ("HP     : " & hpBarX & " , " & hpBarY)
	Call addItemToList ("KMenu  : " & kMenuCornerX & " , " & kMenuCornerY)
	Call addItemToList ("RunTime : " & runTime)
	Call addItemToList("Revive Time : " & reviveTime)

	If Form1.reviveCheckBox.Value = 1 Then 
		Call addItemToList("Revive Enabled")
		shouldRevive = 1
	Else 
		Call addItemToList("Revive Disabled")
		shouldRevive = 0
	End If
	Dim temp
	If mode = 1 Then 
		temp = "RAR"
	Else 
		temp = "FREE"
	End If
	If Form1.extraDelayBox.Value = 1 Then 
		Call addItemToList("Extra Delay: ON")
		extraDelay = 25000
	Else 
		Call addItemToList("Extra Delay: OFF")
		extraDelay = 5000
	End If
	Call addItemToList("Mode : " & temp)
	If Form1.exitScriptCheckBox.Value = 1 Then 
		Call addItemToList("Terminate after boss death")
	Else 
		Call addItemToList("Restart after boss death")
	End If
End Function
Event Form1.OptionBox1.Click
	Call updateStats()
End Event
Event Form1.OptionBox2.Click
	Call updateStats()
End Event
Event Form1.exitScriptCheckBox.Click
	Call updateStats()
End Event


Sub OnScriptExit()
    Call addItemToList("Bot Terminated")
End Sub


